<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redmine 專案戰情室</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        // --- Helper Functions ---
        const isToday = (dateString) => {
            if (!dateString) return false;
            const today = new Date();
            const date = new Date(dateString);
            return date.getDate() === today.getDate() &&
                date.getMonth() === today.getMonth() &&
                date.getFullYear() === today.getFullYear();
        };

        const isPast = (dateString) => {
            if (!dateString) return false;
            const today = new Date();
            today.setHours(0, 0, 0, 0); 
            const date = new Date(dateString);
            return date < today;
        };

        // Helper: Check if status is closed
        const isClosed = (statusName) => {
            if (!statusName) return false;
            const s = statusName.toLowerCase();
            return s === 'closed' || s === 'resolved' || s === 'rejected' || s.includes('已解決') || s.includes('結案') || s.includes('關閉');
        };

        const getBaseUrl = (inputUrl) => {
            try {
                const urlObj = new URL(inputUrl);
                return urlObj.origin; 
            } catch (e) {
                return inputUrl.replace(/\/$/, '');
            }
        };

        const getStatusColor = (status) => {
            const s = status.toLowerCase();
            if (s === 'new' || s === '新建') return 'bg-blue-100 text-blue-800 border-blue-200';
            if (s.includes('progress') || s.includes('進行')) return 'bg-yellow-100 text-yellow-800 border-yellow-200';
            if (s === 'closed' || s === 'resolved' || s.includes('已解決') || s.includes('結案') || s.includes('關閉')) return 'bg-slate-100 text-slate-500 border-slate-200';
            if (s === 'feedback' || s.includes('回饋')) return 'bg-purple-100 text-purple-800 border-purple-200';
            return 'bg-slate-50 text-slate-700 border-slate-200';
        };

        // --- Icons ---
        const Icon = ({ d, className, color }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} style={{ color }}>
                {d}
            </svg>
        );
        const Icons = {
            Activity: <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>,
            Alert: <><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></>,
            Clock: <><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></>,
            User: <><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>,
            Settings: <><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></>,
            Search: <><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></>,
            List: <><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></>,
            Users: <><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></>,
            Play: <polygon points="5 3 19 12 5 21 5 3"></polygon>,
            CheckCircle: <><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></>,
            WifiOff: <><line x1="1" y1="1" x2="23" y2="23"/><path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"/><path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"/><path d="M10.71 5.05A16 16 0 0 1 22.58 9"/><path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" y1="20" x2="12.01" y2="20"/></>
        };

        const Main = () => {
            // --- State ---
            const safeGet = (k, d) => localStorage.getItem(k) || d;
            
            const [config, setConfig] = useState({
                url: safeGet('redmine_url', 'https://igs.redmine-x.com'),
                apiKey: safeGet('redmine_apiKey', ''),
                projectId: safeGet('redmine_projectId', '')
            });
            // Changed default to 'auto' to handle multiple proxies
            const [proxyMode, setProxyMode] = useState(safeGet('redmine_proxyMode', 'auto'));
            const [showSettings, setShowSettings] = useState(false);
            const [issues, setIssues] = useState([]);
            const [currentUser, setCurrentUser] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [statusMsg, setStatusMsg] = useState('');
            
            // UI Filters
            const [filterType, setFilterType] = useState('all'); 

            // --- Effects ---
            useEffect(() => {
                localStorage.setItem('redmine_url', config.url);
                localStorage.setItem('redmine_apiKey', config.apiKey);
                localStorage.setItem('redmine_projectId', config.projectId);
                localStorage.setItem('redmine_proxyMode', proxyMode);
            }, [config, proxyMode]);

            // --- Demo Data ---
            const loadDemoData = () => {
                setLoading(true);
                setError(null);
                setStatusMsg('正在建立模擬資料...');
                setConfig(prev => ({ ...prev, apiKey: 'demo' })); 
                
                setTimeout(() => {
                    const today = new Date().toISOString().split('T')[0];
                    const past = new Date(Date.now() - 86400000 * 3).toISOString().split('T')[0];
                    setIssues([
                        { id: 101, subject: '伺服器異常排查', project: { name: 'Infra' }, status: { name: 'New' }, assigned_to: { id: 1, name: 'Admin User' }, due_date: today },
                        { id: 102, subject: '前端介面 RWD 優化', project: { name: 'Web App' }, status: { name: 'In Progress' }, assigned_to: { id: 2, name: 'John Doe' }, due_date: past },
                        { id: 103, subject: '金流 API 串接測試', project: { name: 'Web App' }, status: { name: 'Feedback' }, assigned_to: { id: 1, name: 'Admin User' }, due_date: null },
                        { id: 104, subject: '每週自動備份腳本', project: { name: 'Backend' }, status: { name: 'New' }, assigned_to: { id: 3, name: 'Jane Smith' }, due_date: today },
                        { id: 105, subject: '2024 年度報表匯出功能', project: { name: 'Web App' }, status: { name: 'New' }, assigned_to: { id: 2, name: 'John Doe' }, due_date: past },
                        { id: 106, subject: '防火牆規則更新 (已完成)', project: { name: 'Infra' }, status: { name: 'Closed' }, assigned_to: { id: 1, name: 'Admin User' }, due_date: past },
                        { id: 107, subject: '使用者登入逾時問題', project: { name: 'Web App' }, status: { name: 'In Progress' }, assigned_to: { id: 3, name: 'Jane Smith' }, due_date: today },
                        { id: 108, subject: 'iOS App 上架審核', project: { name: 'Mobile' }, status: { name: 'In Progress' }, assigned_to: { id: 1, name: 'Admin User' }, due_date: today },
                        { id: 109, subject: '資料庫遷移 (歷史)', project: { name: 'Backend' }, status: { name: 'Closed' }, assigned_to: { id: 3, name: 'Jane Smith' }, due_date: past },
                    ]);
                    setCurrentUser({ id: 1, firstname: 'Admin', lastname: 'User' });
                    setLoading(false);
                    setStatusMsg('');
                }, 600);
            };

            // --- Fetch Logic (Enhanced Proxy) ---
            const fetchData = async () => {
                if (config.apiKey.toLowerCase() === 'demo') {
                    loadDemoData();
                    return;
                }

                if (!config.apiKey) { setError('請先輸入 API Token'); return; }
                
                // HTTPS Mixed Content Check
                if (window.location.protocol === 'https:' && config.url.startsWith('http:')) {
                    setError('安全性錯誤：您的網站位於 HTTPS (如 GitHub Pages)，但 Redmine 是 HTTP。瀏覽器禁止此類「混合內容」連線。解決方法：請為 Redmine 啟用 HTTPS，或使用 Demo 模式測試。');
                    return;
                }

                setLoading(true); 
                setError(null);
                setStatusMsg('準備連線...');

                // Proxy Providers List
                // We use 'key' param in URL for proxies to avoid Header stripping issues
                const proxyProviders = [
                    { name: 'CorsProxy.io', fn: (target) => `https://corsproxy.io/?${encodeURIComponent(target)}` },
                    { name: 'AllOrigins', fn: (target) => `https://api.allorigins.win/raw?url=${encodeURIComponent(target)}` },
                    { name: 'CodeTabs', fn: (target) => `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(target)}` }
                ];

                const fetchWithRetry = async (path) => {
                    const targetUrl = `${config.url}${path}${path.includes('?')?'&':'?'}key=${config.apiKey}&limit=100&status_id=*`;
                    
                    if (proxyMode === 'direct') {
                        setStatusMsg('嘗試直連...');
                        const res = await fetch(targetUrl, { headers: {'X-Redmine-API-Key': config.apiKey}});
                        if (!res.ok) throw new Error(`直連失敗 (${res.status})`);
                        return await res.json();
                    }

                    // Auto Proxy Mode: Loop through providers
                    let lastErr = null;
                    for (const provider of proxyProviders) {
                        try {
                            setStatusMsg(`嘗試連線中 (${provider.name})...`);
                            const proxyUrl = provider.fn(targetUrl);
                            const res = await fetch(proxyUrl);
                            if (!res.ok) throw new Error(`HTTP ${res.status}`);
                            return await res.json();
                        } catch (e) {
                            console.warn(`${provider.name} failed:`, e);
                            lastErr = e;
                        }
                    }
                    throw new Error('所有連線方式皆失敗。請確認 Redmine 網址正確，或檢查是否被防火牆阻擋。');
                };

                try {
                    const [userRes, issuesRes] = await Promise.all([
                        fetchWithRetry('/users/current.json'),
                        fetchWithRetry('/issues.json')
                    ]);
                    
                    setCurrentUser(userRes.user);
                    setIssues(issuesRes.issues);
                    setStatusMsg('');
                } catch (err) {
                    console.error(err);
                    let niceError = err.message;
                    if (err.message.includes('Failed to fetch') || err.message.includes('NetworkError')) {
                        niceError = '網路連線失敗 (CORS Blocked)。如果您部署在 GitHub Pages，這通常是因為瀏覽器安全性限制，阻止了對第三方伺服器的請求。建議使用「公共 Proxy」模式嘗試。';
                    }
                    setError(niceError);
                } finally {
                    setLoading(false);
                }
            };

            // --- Filtering Logic ---
            const filteredIssues = useMemo(() => {
                let res = issues;
                
                if (filterType === 'closed') {
                    return res.filter(i => isClosed(i.status?.name));
                }

                res = res.filter(i => !isClosed(i.status?.name));

                if (filterType === 'today') {
                    res = res.filter(i => isToday(i.due_date));
                }
                if (filterType === 'overdue') {
                    res = res.filter(i => isPast(i.due_date));
                }
                if (filterType === 'my' && currentUser) {
                    res = res.filter(i => i.assigned_to?.id === currentUser.id);
                }
                return res;
            }, [issues, filterType, currentUser]);

            // --- UI Components ---
            const StatCard = ({ label, val, color, icon, active, onClick }) => (
                <div onClick={onClick} className={`bg-white p-4 rounded-xl border border-slate-100 shadow-sm cursor-pointer transition-all hover:shadow-md ${active ? 'ring-2 ring-blue-500 bg-blue-50' : ''}`}>
                    <div className="flex justify-between items-center">
                        <div>
                            <p className="text-slate-500 text-xs font-bold uppercase tracking-wider">{label}</p>
                            <p className={`text-2xl font-bold mt-1 ${color}`}>{val}</p>
                        </div>
                        <div className={`p-2 rounded-lg bg-slate-100 text-slate-400`}>
                            <Icon d={icon} className="w-5 h-5" />
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen pb-12">
                    {/* Header */}
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-20">
                        <div className="max-w-7xl mx-auto px-4 py-3">
                            <div className="flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    <div className="bg-slate-900 text-white p-2 rounded-lg">
                                        <Icon d={Icons.Activity} className="w-5 h-5" />
                                    </div>
                                    <div>
                                        <h1 className="text-lg font-bold text-slate-800">專案戰情室</h1>
                                        {currentUser && <p className="text-xs text-slate-500">Hi, {currentUser.firstname}</p>}
                                    </div>
                                </div>

                                <div className="flex items-center gap-2">
                                    <input 
                                        type="password" 
                                        placeholder="輸入 Token 或 demo" 
                                        className="bg-slate-50 border border-slate-200 rounded px-3 py-1.5 text-sm w-32 focus:w-48 transition-all outline-none focus:ring-2 focus:ring-blue-500"
                                        value={config.apiKey}
                                        onChange={e => setConfig({...config, apiKey: e.target.value})}
                                    />
                                    
                                    <button 
                                        onClick={fetchData} 
                                        disabled={loading}
                                        className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-1.5 rounded text-sm font-bold flex items-center gap-2 min-w-[80px] justify-center"
                                    >
                                        {loading ? <span className="animate-spin">⌛</span> : <><Icon d={Icons.Search} className="w-4 h-4" /> 分析</>}
                                    </button>

                                    <button 
                                        onClick={loadDemoData}
                                        className="bg-emerald-100 text-emerald-700 hover:bg-emerald-200 px-3 py-1.5 rounded text-sm font-bold flex items-center gap-1 transition-colors"
                                        title="使用範例資料預覽"
                                    >
                                        <Icon d={Icons.Play} className="w-3 h-3 fill-current" />
                                        試用 Demo
                                    </button>

                                    <button 
                                        onClick={() => setShowSettings(!showSettings)}
                                        className={`p-2 rounded text-slate-400 hover:bg-slate-100 ${showSettings ? 'text-blue-600 bg-blue-50' : ''}`}
                                    >
                                        <Icon d={Icons.Settings} className="w-5 h-5" />
                                    </button>
                                </div>
                            </div>

                            {/* Collapsible Settings */}
                            {showSettings && (
                                <div className="mt-3 pt-3 border-t border-slate-100 flex gap-4 animate-fadeIn">
                                    <div className="flex-1">
                                        <label className="text-xs text-slate-500 block mb-1">Redmine 網址 (包含 https://)</label>
                                        <input 
                                            className="w-full bg-slate-50 border border-slate-200 rounded px-2 py-1 text-sm text-slate-600 focus:ring-2 focus:ring-blue-500 outline-none"
                                            value={config.url}
                                            onChange={e => setConfig({...config, url: e.target.value})}
                                            placeholder="https://redmine.example.com"
                                        />
                                    </div>
                                    <div className="w-48">
                                        <label className="text-xs text-slate-500 block mb-1">連線模式</label>
                                        <select 
                                            className="w-full bg-slate-50 border border-slate-200 rounded px-2 py-1 text-sm text-slate-600"
                                            value={proxyMode}
                                            onChange={e => setProxyMode(e.target.value)}
                                        >
                                            <option value="auto">自動選擇 Proxy (推薦)</option>
                                            <option value="direct">直連 (僅限內網/本地)</option>
                                        </select>
                                    </div>
                                </div>
                            )}
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 py-6 space-y-8">
                        {statusMsg && !error && (
                            <div className="flex justify-center animate-pulse text-blue-600 font-bold text-sm">
                                {statusMsg}
                            </div>
                        )}

                        {error && (
                            <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-4 rounded-lg flex items-start gap-3 animate-fadeIn shadow-sm">
                                <Icon d={Icons.WifiOff} className="w-6 h-6 mt-0.5 shrink-0" /> 
                                <div>
                                    <div className="font-bold mb-1">連線發生錯誤</div>
                                    <div className="text-sm opacity-90">{error}</div>
                                </div>
                            </div>
                        )}

                        {/* Main Content */}
                        {issues.length > 0 ? (
                            <section className="animate-fadeIn">
                                {/* Stats - Modified to 5 cols for LG screens */}
                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6">
                                    <StatCard 
                                        label="所有待辦" 
                                        val={issues.filter(i => !isClosed(i.status?.name)).length} 
                                        color="text-slate-800" 
                                        icon={Icons.List} 
                                        active={filterType === 'all'}
                                        onClick={() => setFilterType('all')}
                                    />
                                    <StatCard 
                                        label="今日待辦" 
                                        val={issues.filter(i => isToday(i.due_date) && !isClosed(i.status?.name)).length} 
                                        color="text-blue-600" 
                                        icon={Icons.Clock} 
                                        active={filterType === 'today'}
                                        onClick={() => setFilterType('today')}
                                    />
                                    <StatCard 
                                        label="逾期案件" 
                                        val={issues.filter(i => isPast(i.due_date) && !isClosed(i.status?.name)).length} 
                                        color="text-red-600" 
                                        icon={Icons.Alert} 
                                        active={filterType === 'overdue'}
                                        onClick={() => setFilterType('overdue')}
                                    />
                                    <StatCard 
                                        label="我的待辦" 
                                        val={currentUser ? issues.filter(i => i.assigned_to?.id === currentUser.id && !isClosed(i.status?.name)).length : 0} 
                                        color="text-emerald-600" 
                                        icon={Icons.Users} 
                                        active={filterType === 'my'}
                                        onClick={() => setFilterType('my')}
                                    />
                                    <StatCard 
                                        label="已結案" 
                                        val={issues.filter(i => isClosed(i.status?.name)).length} 
                                        color="text-slate-400" 
                                        icon={Icons.CheckCircle} 
                                        active={filterType === 'closed'}
                                        onClick={() => setFilterType('closed')}
                                    />
                                </div>

                                {/* List */}
                                <div className="bg-white border border-slate-200 rounded-xl overflow-hidden shadow-sm">
                                    <div className="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                                        <h3 className="font-bold text-slate-700">
                                            {filterType === 'all' ? '待辦案件列表' : 
                                             filterType === 'today' ? '今日到期案件' : 
                                             filterType === 'overdue' ? '逾期案件列表' : 
                                             filterType === 'my' ? '我的待辦列表' : 
                                             '已結案歷史紀錄'}
                                        </h3>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-sm text-left">
                                            <thead className="bg-slate-50 text-slate-500 uppercase text-xs">
                                                <tr>
                                                    <th className="px-6 py-3">#</th>
                                                    <th className="px-6 py-3">狀態</th>
                                                    <th className="px-6 py-3 w-1/3">主題</th>
                                                    <th className="px-6 py-3">負責人</th>
                                                    <th className="px-6 py-3">期限</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-100">
                                                {filteredIssues.map(issue => {
                                                    const isOverdue = isPast(issue.due_date) && !isClosed(issue.status?.name);
                                                    return (
                                                        <tr key={issue.id} className="hover:bg-slate-50 transition-colors">
                                                            <td className="px-6 py-4 font-mono text-blue-600 font-bold">
                                                                <a href={`${config.url}/issues/${issue.id}`} target="_blank" className="hover:underline">#{issue.id}</a>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <span className={`px-2 py-1 rounded text-xs font-bold ${getStatusColor(issue.status.name)}`}>
                                                                    {issue.status.name}
                                                                </span>
                                                            </td>
                                                            <td className="px-6 py-4 font-medium text-slate-700">
                                                                <div className="text-xs text-slate-400 mb-0.5">{issue.project?.name}</div>
                                                                {issue.subject}
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div className="flex items-center gap-2">
                                                                    <div className="w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center text-[10px] font-bold text-slate-600">
                                                                        {issue.assigned_to?.name.charAt(0)}
                                                                    </div>
                                                                    <span className="text-slate-600">{issue.assigned_to?.name}</span>
                                                                </div>
                                                            </td>
                                                            <td className={`px-6 py-4 ${isOverdue ? 'text-red-600 font-bold' : 'text-slate-500'}`}>
                                                                {issue.due_date || '-'}
                                                            </td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                        {filteredIssues.length === 0 && (
                                            <div className="p-8 text-center text-slate-400">此篩選條件下沒有案件</div>
                                        )}
                                    </div>
                                </div>
                            </section>
                        ) : (
                            // Welcome / Empty State
                            !loading && !error && (
                                <div className="flex flex-col items-center justify-center py-20 text-center animate-fadeIn">
                                    <div className="bg-white p-4 rounded-full shadow-sm mb-6">
                                        <Icon d={Icons.Activity} className="w-12 h-12 text-slate-300" />
                                    </div>
                                    <h2 className="text-xl font-bold text-slate-700 mb-2">準備開始工作</h2>
                                    <p className="text-slate-500 max-w-md mb-8">
                                        請在上方輸入您的 Redmine API Token 即可取得資料。<br/>
                                        如果您部署在 GitHub Pages，請確保選擇「自動選擇 Proxy」模式。
                                    </p>
                                    <button 
                                        onClick={loadDemoData}
                                        className="bg-white border border-slate-200 text-slate-600 hover:text-blue-600 hover:border-blue-200 px-6 py-2 rounded-full font-bold shadow-sm transition-all flex items-center gap-2"
                                    >
                                        <Icon d={Icons.Play} className="w-4 h-4" />
                                        載入範例資料 (Demo)
                                    </button>
                                </div>
                            )
                        )}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Main />);
    </script>
</body>
</html>